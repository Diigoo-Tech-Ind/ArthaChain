syntax = "proto3";

package arthachain;

// ArthaChain gRPC API Service
service ArthaChainService {
    // Blockchain information
    rpc GetBlockchainInfo(GetBlockchainInfoRequest) returns (GetBlockchainInfoResponse);
    rpc GetLatestBlock(GetLatestBlockRequest) returns (GetLatestBlockResponse);
    rpc GetBlockByHash(GetBlockByHashRequest) returns (GetBlockByHashResponse);
    rpc GetBlockByHeight(GetBlockByHeightRequest) returns (GetBlockByHeightResponse);
    
    // Transaction operations
    rpc GetTransaction(GetTransactionRequest) returns (GetTransactionResponse);
    rpc SubmitTransaction(SubmitTransactionRequest) returns (SubmitTransactionResponse);
    rpc GetTransactionReceipt(GetTransactionReceiptRequest) returns (GetTransactionReceiptResponse);
    
    // Account operations
    rpc GetAccount(GetAccountRequest) returns (GetAccountResponse);
    rpc GetAccountBalance(GetAccountBalanceRequest) returns (GetAccountBalanceResponse);
    rpc GetAccountTransactions(GetAccountTransactionsRequest) returns (GetAccountTransactionsResponse);
    
    // Smart contract operations
    rpc GetContract(GetContractRequest) returns (GetContractResponse);
    rpc CallContract(CallContractRequest) returns (CallContractResponse);
    rpc DeployContract(DeployContractRequest) returns (DeployContractResponse);
    
    // Network and consensus
    rpc GetNetworkStatus(GetNetworkStatusRequest) returns (GetNetworkStatusResponse);
    rpc GetValidators(GetValidatorsRequest) returns (GetValidatorsResponse);
    rpc GetConsensusStatus(GetConsensusStatusRequest) returns (GetConsensusStatusResponse);
    
    // Explorer and analytics
    rpc GetBlockchainStats(GetBlockchainStatsRequest) returns (GetBlockchainStatsResponse);
    rpc GetRecentBlocks(GetRecentBlocksRequest) returns (GetRecentBlocksResponse);
    rpc GetRecentTransactions(GetRecentTransactionsRequest) returns (GetRecentTransactionsResponse);
    
    // Health and monitoring
    rpc HealthCheck(HealthCheckRequest) returns (HealthCheckResponse);
    rpc GetMetrics(GetMetricsRequest) returns (GetMetricsResponse);
}

// Request/Response messages for blockchain operations
message GetBlockchainInfoRequest {}

message GetBlockchainInfoResponse {
    string network_name = 1;
    uint64 chain_id = 2;
    uint64 latest_block_height = 3;
    uint64 total_transactions = 4;
    uint32 active_validators = 5;
    string consensus_mechanism = 6;
    repeated string features = 7;
}

message GetLatestBlockRequest {}

message GetLatestBlockResponse {
    Block block = 1;
}

message GetBlockByHashRequest {
    string hash = 1;
}

message GetBlockByHashResponse {
    Block block = 1;
}

message GetBlockByHeightRequest {
    uint64 height = 1;
}

message GetBlockByHeightResponse {
    Block block = 1;
}

// Transaction messages
message GetTransactionRequest {
    string hash = 1;
}

message GetTransactionResponse {
    Transaction transaction = 1;
}

message SubmitTransactionRequest {
    Transaction transaction = 1;
}

message SubmitTransactionResponse {
    string tx_hash = 1;
    bool success = 2;
    string error_message = 3;
}

message GetTransactionReceiptRequest {
    string hash = 1;
}

message GetTransactionReceiptResponse {
    TransactionReceipt receipt = 1;
}

// Account messages
message GetAccountRequest {
    string address = 1;
}

message GetAccountResponse {
    Account account = 1;
}

message GetAccountBalanceRequest {
    string address = 1;
}

message GetAccountBalanceResponse {
    string balance = 1;
    string currency = 2;
}

message GetAccountTransactionsRequest {
    string address = 1;
    uint32 limit = 2;
    uint32 offset = 3;
}

message GetAccountTransactionsResponse {
    repeated Transaction transactions = 1;
    uint32 total_count = 2;
}

// Smart contract messages
message GetContractRequest {
    string address = 1;
}

message GetContractResponse {
    Contract contract = 1;
}

message CallContractRequest {
    string contract_address = 1;
    string caller_address = 2;
    bytes data = 3;
    uint64 gas_limit = 4;
    string value = 5;
}

message CallContractResponse {
    bytes result = 1;
    uint64 gas_used = 2;
    bool success = 3;
    string error_message = 4;
}

message DeployContractRequest {
    string deployer_address = 1;
    bytes bytecode = 2;
    bytes constructor_args = 3;
    uint64 gas_limit = 4;
}

message DeployContractResponse {
    string contract_address = 1;
    string tx_hash = 2;
    bool success = 3;
    string error_message = 4;
}

// Network and consensus messages
message GetNetworkStatusRequest {}

message GetNetworkStatusResponse {
    uint32 connected_peers = 1;
    uint32 total_peers = 2;
    string network_id = 3;
    uint64 uptime = 4;
    repeated string peer_addresses = 5;
}

message GetValidatorsRequest {}

message GetValidatorsResponse {
    repeated Validator validators = 1;
    uint32 total_count = 2;
}

message GetConsensusStatusRequest {}

message GetConsensusStatusResponse {
    string status = 1;
    uint64 current_round = 2;
    uint32 active_validators = 3;
    string consensus_mechanism = 4;
    uint64 block_time = 5;
}

// Explorer and analytics messages
message GetBlockchainStatsRequest {}

message GetBlockchainStatsResponse {
    uint64 latest_block = 1;
    string block_time = 2;
    uint64 active_validators = 3;
    string total_transactions = 4;
    uint64 total_blocks = 5;
    string network_hash_rate = 6;
}

message GetRecentBlocksRequest {
    uint32 limit = 1;
}

message GetRecentBlocksResponse {
    repeated Block blocks = 1;
}

message GetRecentTransactionsRequest {
    uint32 limit = 1;
}

message GetRecentTransactionsResponse {
    repeated Transaction transactions = 1;
}

// Health and monitoring messages
message HealthCheckRequest {}

message HealthCheckResponse {
    string status = 1;
    uint64 timestamp = 2;
    string service = 3;
    string version = 4;
    string uptime = 5;
}

message GetMetricsRequest {}

message GetMetricsResponse {
    map<string, string> metrics = 1;
}

// Core data structures
message Block {
    uint64 height = 1;
    string hash = 2;
    string previous_hash = 3;
    uint64 timestamp = 4;
    repeated Transaction transactions = 5;
    string merkle_root = 6;
    uint64 nonce = 7;
    uint64 difficulty = 8;
    string producer = 9;
    uint32 transaction_count = 10;
    uint64 size = 11;
}

message Transaction {
    string hash = 1;
    string from = 2;
    string to = 3;
    string value = 4;
    uint64 gas_limit = 5;
    uint64 gas_price = 6;
    bytes data = 7;
    uint64 nonce = 8;
    uint64 timestamp = 9;
    string status = 10;
    uint64 block_height = 11;
    string block_hash = 12;
}

message TransactionReceipt {
    string tx_hash = 1;
    uint64 block_height = 2;
    string block_hash = 3;
    uint64 gas_used = 4;
    bool success = 5;
    string error_message = 6;
    repeated Log logs = 7;
    string contract_address = 8;
}

message Log {
    string address = 1;
    repeated string topics = 2;
    bytes data = 3;
    uint64 log_index = 4;
}

message Account {
    string address = 1;
    string balance = 2;
    uint64 nonce = 3;
    string code_hash = 4;
    bool is_contract = 5;
    map<string, string> storage = 6;
}

message Contract {
    string address = 1;
    string code_hash = 2;
    bytes bytecode = 3;
    string creator = 4;
    uint64 creation_height = 5;
    string creation_tx_hash = 6;
    map<string, string> storage = 7;
}

message Validator {
    string address = 1;
    string public_key = 2;
    string stake = 3;
    bool is_active = 4;
    uint64 commission_rate = 5;
    uint64 last_block_height = 6;
    uint64 total_blocks = 7;
    string status = 8;
}