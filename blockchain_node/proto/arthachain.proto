syntax = "proto3";

package arthachain;

// ArthaChain gRPC Service Definition
service ArthaChainService {
    // Blockchain Information
    rpc GetBlockchainInfo(GetBlockchainInfoRequest) returns (GetBlockchainInfoResponse);
    rpc GetLatestBlock(GetLatestBlockRequest) returns (GetLatestBlockResponse);
    rpc GetBlockByHash(GetBlockByHashRequest) returns (GetBlockByHashResponse);
    rpc GetBlockByHeight(GetBlockByHeightRequest) returns (GetBlockByHeightResponse);
    
    // Transaction Operations
    rpc GetTransaction(GetTransactionRequest) returns (GetTransactionResponse);
    rpc SubmitTransaction(SubmitTransactionRequest) returns (SubmitTransactionResponse);
    
    // Network Information
    rpc GetNetworkStatus(GetNetworkStatusRequest) returns (GetNetworkStatusResponse);
    rpc GetPeerInfo(GetPeerInfoRequest) returns (GetPeerInfoResponse);
    
    // Health and Monitoring
    rpc HealthCheck(HealthCheckRequest) returns (HealthCheckResponse);
    rpc GetMetrics(GetMetricsRequest) returns (GetMetricsResponse);
    
    // Consensus Information
    rpc GetConsensusStatus(GetConsensusStatusRequest) returns (GetConsensusStatusResponse);
    rpc GetValidators(GetValidatorsRequest) returns (GetValidatorsResponse);
    
    // Extended functionality
    rpc GetTransactionReceipt(GetTransactionReceiptRequest) returns (GetTransactionReceiptResponse);
    rpc GetAccount(GetAccountRequest) returns (GetAccountResponse);
    rpc GetAccountBalance(GetAccountBalanceRequest) returns (GetAccountBalanceResponse);
    rpc GetAccountTransactions(GetAccountTransactionsRequest) returns (GetAccountTransactionsResponse);
    rpc GetContract(GetContractRequest) returns (GetContractResponse);
    rpc CallContract(CallContractRequest) returns (CallContractResponse);
    rpc DeployContract(DeployContractRequest) returns (DeployContractResponse);
    rpc GetBlockchainStats(GetBlockchainStatsRequest) returns (GetBlockchainStatsResponse);
    rpc GetRecentBlocks(GetRecentBlocksRequest) returns (GetRecentBlocksResponse);
    rpc GetRecentTransactions(GetRecentTransactionsRequest) returns (GetRecentTransactionsResponse);
}

// Request/Response Messages
message GetBlockchainInfoRequest {}

message GetBlockchainInfoResponse {
    string network_name = 1;
    uint64 chain_id = 2;
    uint64 latest_block_height = 3;
    uint64 total_transactions = 4;
    uint32 active_validators = 5;
    string consensus_mechanism = 6;
    repeated string features = 7;
}

message GetLatestBlockRequest {}

message GetLatestBlockResponse {
    Block block = 1;
}

message GetBlockByHashRequest {
    string hash = 1;
}

message GetBlockByHashResponse {
    Block block = 1;
}

message GetBlockByHeightRequest {
    uint64 height = 1;
}

message GetBlockByHeightResponse {
    Block block = 1;
}

message GetTransactionRequest {
    string hash = 1;
}

message GetTransactionResponse {
    Transaction transaction = 1;
}

message SubmitTransactionRequest {
    bytes raw_transaction = 1;
}

message SubmitTransactionResponse {
    string transaction_hash = 1;
    bool success = 2;
    string error_message = 3;
}

message GetNetworkStatusRequest {}

message GetNetworkStatusResponse {
    uint32 connected_peers = 1;
    string network_version = 2;
    bool syncing = 3;
    uint64 sync_height = 4;
    uint64 current_height = 5;
}

message GetPeerInfoRequest {}

message GetPeerInfoResponse {
    repeated Peer peers = 1;
}

message HealthCheckRequest {}

message HealthCheckResponse {
    string status = 1;
    uint64 uptime = 2;
    string version = 3;
    uint64 timestamp = 4;
    string service = 5;
}

message GetMetricsRequest {}

message GetMetricsResponse {
    SystemMetrics system = 1;
    BlockchainMetrics blockchain = 2;
    NetworkMetrics network = 3;
    AIMetrics ai_metrics = 4;
    ConsensusMetrics consensus_metrics = 5;
    uint64 timestamp = 6;
}

message GetConsensusStatusRequest {}

message GetConsensusStatusResponse {
    ConsensusStatus consensus_status = 1;
}

message ConsensusStatus {
    string phase = 1;
    uint64 round = 2;
    string leader = 3;
    uint32 active_validators = 4;
    uint64 total_stake = 5;
}

message GetValidatorsRequest {}

message GetValidatorsResponse {
    repeated Validator validators = 1;
}

// Data Structures
message Block {
    uint64 height = 1;
    string hash = 2;
    string previous_hash = 3;
    uint64 timestamp = 4;
    repeated Transaction transactions = 5;
    string merkle_root = 6;
    uint64 nonce = 7;
    uint64 difficulty = 8;
    string producer = 9;
    uint32 transaction_count = 10;
    uint64 size = 11;
}

message Transaction {
    string hash = 1;
    string from = 2;
    string to = 3;
    uint64 amount = 4;
    uint64 gas_limit = 5;
    uint64 gas_price = 6;
    uint64 nonce = 7;
    bytes data = 8;
    string signature = 9;
    uint64 timestamp = 10;
    TransactionStatus status = 11;
}

enum TransactionStatus {
    PENDING = 0;
    CONFIRMED = 1;
    FAILED = 2;
}

message Peer {
    string id = 1;
    string address = 2;
    string version = 3;
    bool connected = 4;
    uint64 last_seen = 5;
}

message SystemMetrics {
    double cpu_usage = 1;
    uint64 memory_usage = 2;
    uint64 disk_usage = 3;
    uint64 network_io = 4;
}

message BlockchainMetrics {
    uint64 total_blocks = 1;
    uint64 total_transactions = 2;
    double tps = 3;
    uint64 mempool_size = 4;
}

message NetworkMetrics {
    uint32 connected_peers = 1;
    uint64 bytes_sent = 2;
    uint64 bytes_received = 3;
    double latency_ms = 4;
}

message Validator {
    string address = 1;
    uint64 stake = 2;
    uint64 delegated_stake = 3;
    bool active = 4;
    uint64 blocks_proposed = 5;
    double uptime = 6;
}

message AIMetrics {
    double model_accuracy = 1;
    uint64 inference_count = 2;
    double avg_inference_time = 3;
    uint64 memory_usage = 4;
    uint64 cpu_usage = 5;
}

message ConsensusMetrics {
    uint64 total_rounds = 1;
    double avg_block_time = 2;
    uint64 successful_proposals = 3;
    uint64 failed_proposals = 4;
    double network_efficiency = 5;
}

// Additional request/response messages for extended functionality
message GetTransactionReceiptRequest {
    string transaction_hash = 1;
}

message GetTransactionReceiptResponse {
    TransactionReceipt receipt = 1;
}

message TransactionReceipt {
    string transaction_hash = 1;
    string block_hash = 2;
    uint64 block_number = 3;
    uint64 gas_used = 4;
    bool status = 5;
    string contract_address = 6;
    repeated string logs = 7;
}

message GetAccountRequest {
    string address = 1;
}

message GetAccountResponse {
    Account account = 1;
}

message Account {
    string address = 1;
    uint64 balance = 2;
    uint64 nonce = 3;
    bool is_contract = 4;
    string code_hash = 5;
    uint64 storage_root = 6;
}

message GetAccountBalanceRequest {
    string address = 1;
}

message GetAccountBalanceResponse {
    uint64 balance = 1;
}

message GetAccountTransactionsRequest {
    string address = 1;
    uint32 limit = 2;
    uint32 offset = 3;
}

message GetAccountTransactionsResponse {
    repeated Transaction transactions = 1;
    uint32 total_count = 2;
}

message GetContractRequest {
    string address = 1;
}

message GetContractResponse {
    Contract contract = 1;
}

message Contract {
    string address = 1;
    bytes bytecode = 2;
    string abi = 3;
    string name = 4;
    string version = 5;
}

message CallContractRequest {
    string contract_address = 1;
    bytes data = 2;
}

message CallContractResponse {
    bytes result = 1;
    bool success = 2;
    string error_message = 3;
}

message DeployContractRequest {
    bytes bytecode = 1;
    bytes constructor_args = 2;
}

message DeployContractResponse {
    string contract_address = 1;
    bool success = 2;
    string error_message = 3;
}

message GetBlockchainStatsRequest {}

message GetBlockchainStatsResponse {
    BlockchainStats stats = 1;
}

message BlockchainStats {
    uint64 total_blocks = 1;
    uint64 total_transactions = 2;
    uint64 total_validators = 3;
    uint64 total_stake = 4;
    double average_block_time = 5;
    double transaction_throughput = 6;
    uint64 cross_shard_transactions = 7;
}

message GetRecentBlocksRequest {
    uint32 limit = 1;
}

message GetRecentBlocksResponse {
    repeated Block blocks = 1;
}

message GetRecentTransactionsRequest {
    uint32 limit = 1;
}

message GetRecentTransactionsResponse {
    repeated Transaction transactions = 1;
}